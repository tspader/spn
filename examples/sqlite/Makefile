EX_SQLITE_SPN_DIR = ../..
EX_SQLITE_DIR_BUILD_EXAMPLES = $(EX_SQLITE_SPN_DIR)/build/examples
EX_SQLITE_BINARY := $(EX_SQLITE_DIR_BUILD_EXAMPLES)/sqlite

SPN := $(EX_SQLITE_SPN_DIR)/build/bin/spn
CC := gcc

EX_SQLITE_FLAG_LANGUAGE := -std=c11
EX_SQLITE_FLAG_OPTIMIZATION := -g
EX_SQLITE_FLAG_OUTPUT := -o $(EX_SQLITE_BINARY)
EX_SQLITE_FLAG_INCLUDE := -I$(shell $(SPN) flags include --package sqlite) -I$(shell $(SPN) flags include --package sp)
EX_SQLITE_FLAG_LIBS := $(shell $(SPN) flags libs --package sqlite)/libsqlite3.a -lm
EX_SQLITE_CC_FLAGS := $(EX_SQLITE_FLAG_LANGUAGE) $(EX_SQLITE_FLAG_OPTIMIZATION) $(EX_SQLITE_FLAG_INCLUDE) $(EX_SQLITE_FLAG_OUTPUT)

all: $(EX_SQLITE_BINARY)

$(EX_SQLITE_DIR_BUILD_EXAMPLES):
	@mkdir -p $(EX_SQLITE_DIR_BUILD_EXAMPLES)

$(EX_SQLITE_BINARY): main.c
	$(SPN) build
	$(CC) main.c $(EX_SQLITE_CC_FLAGS) $(EX_SQLITE_FLAG_LIBS)

.PHONY: all
